(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{129:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=i(a(6));a(52);var o=i(a(1)),l=i(a(197));function i(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.table=o.default.createRef(),a.getData=a.getData.bind(a),a.create=a.create.bind(a),a.changeActive=a.changeActive.bind(a),a.swap=a.swap.bind(a),a.state={page:null},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),n(t,[{key:"componentDidMount",value:function(){this.getData()}},{key:"getData",value:function(){var e=this,t="/admin/news/category/page/1/100";r.default.get(t,function(a){a.error?(r.default.notify("Lấy danh mục bị lỗi!","danger"),console.error("GET: "+t+". "+a.error)):e.setState({page:a.page})},function(e){return r.default.notify("Lấy danh mục bị lỗi!","danger")})}},{key:"create",value:function(){var e=this,t="/admin/news/category";r.default.post(t,function(a){a.error?(r.default.notify("Tạo danh mục bị lỗi!","danger"),console.error("POST: "+t+". "+a.error)):(r.default.showNewsCategoryModal(a.item),e.getData())},function(e){return r.default.notify("Tạo danh mục bị lỗi!","danger")})}},{key:"swap",value:function(e,t){var a=this,n="/admin/news/category/swap/";r.default.put(n,{id:e._id,isMoveUp:t},function(e){e.error?(r.default.notify("Thay đổi vị trí danh mục bị lỗi!","danger"),console.error("PUT: "+n+". "+e.error)):a.getData()},function(e){return r.default.notify("Thay đổi vị trí danh mục bị lỗi!","danger")})}},{key:"changeActive",value:function(e,t){var a=this,n="/admin/news/category";r.default.put(n,{_id:e._id,changes:{active:!e.active}},function(e){if(e.error)r.default.notify("Thay đổi kích hoạt danh mục bị lỗi!","danger"),console.error("PUT: "+n+". "+e.error);else{r.default.notify("Danh mục "+(e.item.active?"được ":"mất ")+"kích hoạt!","info");var o=Object.assign({},a.state);o.page.list[t].active=e.item.active,a.setState(o)}},function(e){return r.default.notify("Thay đổi kích hoạt danh mục bị lỗi!","danger")})}},{key:"delete",value:function(e){var t=this;swal({title:"Tin tức: Xóa danh mục",text:"Bạn có chắc bạn muốn xóa danh mục này?",icon:"warning",dangerMode:!0,buttons:{cancel:!0,confirm:!0}}).then(function(a){if(a){var n="/admin/news/category";r.default.delete(n,{id:e._id},function(e){e.error?(r.default.notify("Xóa danh mục bị lỗi!","danger"),console.error("DELETE: "+n+". "+e.error)):(swal({text:"Danh mục được xóa thành công!",icon:"error",button:!1,timer:1500}),t.getData())},function(e){return r.default.notify("Xóa danh mục bị lỗi!","danger")})}})}},{key:"render",value:function(){var e=this,t=null;return t=this.state.page&&this.state.page.list&&this.state.page.list.length>0?o.default.createElement("table",{className:"table table-hover table-bordered",ref:this.table},o.default.createElement("thead",null,o.default.createElement("tr",null,o.default.createElement("th",{style:{width:"80%"}},"Title"),o.default.createElement("th",{style:{width:"20%",textAlign:"center"}},"Image"),o.default.createElement("th",{style:{width:"auto"}},"Active"),o.default.createElement("th",{style:{width:"auto",textAlign:"center"}},"Actions"))),o.default.createElement("tbody",null,this.state.page.list.map(function(t,a){return o.default.createElement("tr",{key:a},o.default.createElement("td",null,t.title),o.default.createElement("td",{style:{width:"20%",textAlign:"center"}},o.default.createElement("img",{src:r.default.url(t.image),alt:"avatar",style:{height:"32px"}})),o.default.createElement("td",{className:"toggle",style:{textAlign:"center"}},o.default.createElement("label",null,o.default.createElement("input",{type:"checkbox",defaultChecked:t.active,onClick:function(){return e.changeActive(t,a)}}),o.default.createElement("span",{className:"button-indecator"}))),o.default.createElement("td",{className:"btn-group"},o.default.createElement("a",{className:"btn btn-success",href:"#",onClick:function(){return e.swap(t,!0)}},o.default.createElement("i",{className:"fa fa-lg fa-arrow-up"})),o.default.createElement("a",{className:"btn btn-success",href:"#",onClick:function(){return e.swap(t,!1)}},o.default.createElement("i",{className:"fa fa-lg fa-arrow-down"})),o.default.createElement("a",{className:"btn btn-primary",href:"#",onClick:function(){return r.default.showNewsCategoryModal(t)}},o.default.createElement("i",{className:"fa fa-lg fa-edit"})),o.default.createElement("a",{className:"btn btn-danger",href:"#",onClick:function(){return e.delete(t)}},o.default.createElement("i",{className:"fa fa-lg fa-trash"}))))}))):o.default.createElement("p",null,"Không có danh mục!"),o.default.createElement("main",{className:"app-content"},o.default.createElement("div",{className:"app-title"},o.default.createElement("div",null,o.default.createElement("h1",null,o.default.createElement("i",{className:"fa fa-dashboard"}),"Tin tức: Danh mục"),o.default.createElement("p",null)),o.default.createElement("ul",{className:"app-breadcrumb breadcrumb"},o.default.createElement("li",{className:"breadcrumb-item"},o.default.createElement("i",{className:"fa fa-home fa-lg"})),o.default.createElement("li",{className:"breadcrumb-item"},o.default.createElement("a",{href:"#"},"Tin tức: Danh mục")))),o.default.createElement("div",{className:"row tile"},t),o.default.createElement("button",{type:"button",className:"btn btn-primary btn-circle",style:{position:"fixed",right:"10px",bottom:"10px"},onClick:this.create},o.default.createElement("i",{className:"fa fa-lg fa-plus"})),o.default.createElement(l.default,{onSaveSuccess:this.getData}))}}]),t}();t.default=c},154:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=l(a(6));a(155);var o=l(a(1));function l(e){return e&&e.__esModule?e:{default:e}}var i={backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain",width:"auto",height:"124px",color:"black",border:"1px dashed #333"},c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.setImage=a.setImage.bind(a),a.box=o.default.createRef(),a.progress=o.default.createRef(),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),n(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){var t=$(e.box.current),a=$(e.progress.current);t.mfupload({type:e.props.fileType?e.props.fileType:"png, jpg, jpeg, bmp",maxsize:e.props.maxSize?e.props.maxSize:5,post_upload:e.props.postUrl,folder:"./",ini_text:e.props.innerText?e.props.innerText:"",over_text:e.props.overText?e.props.overText:"Thả hình ảnh xuống ô này!",over_col:e.props.overColor?e.props.overColor:"#fff",over_bkcol:e.props.overBackColor?e.props.overBackColor:"#0e7dc2",init:function(){},loaded:function(e){t.css("display","none"),e.error||e.image&&t.css("background-image","url("+r.default.url(e.image)+")")},progress:function(e){return a.text("Upload "+e.perc+"%")},error:function(e){t.css("display","block"),r.default.notify("Tải hình bị lỗi: "+e,"danger"),console.log("UploadBox",e)},completed:function(){t.css("display","block"),a.text("")}})},500)}},{key:"setImage",value:function(e){$(this.box.current).css("background-image","url("+r.default.url(e)+")")}},{key:"render",value:function(){return[o.default.createElement("div",{ref:this.box,id:this.props.uploadType,style:i,key:0}),o.default.createElement("small",{className:"form-text text-primary",style:{textAlign:"center"},key:1},this.props.description?this.props.description:"Nhấp hoặc kéo hình ảnh thả vào ô phía trên!"),o.default.createElement("small",{ref:this.progress,className:"form-text text-muted",style:{textAlign:"center"},key:2})]}}]),t}();t.default=c,c.propTypes={fileType:r.default.PropTypes.string,maxSize:r.default.PropTypes.number,uploadType:r.default.PropTypes.string.isRequired,innerText:r.default.PropTypes.string,overText:r.default.PropTypes.string,overColor:r.default.PropTypes.string,overBackColor:r.default.PropTypes.string,description:r.default.PropTypes.string,postUrl:r.default.PropTypes.string.isRequired}},155:function(e,t,a){"use strict";!function(e){var t,a={completed:function(){},start:function(){},loaded:function(){},progress:function(){},error:function(){},upload_old:function(a,n){t.init();var r={fileno:-1,filename:a.attr("value").replace(/^.*[\\\/]/,""),perc:0,sent:0,total:0};t.start(r),e('<iframe id="'+n+'" name="'+n+'" src="#" style="display:none"></iframe>').appendTo("body"),e("#"+n).bind("load",function(){var a=e("#"+n).contents().find("body").html(),r=jQuery.parseJSON(a);r.fileno=-1,t.loaded(r),t.completed(),e("#"+n).unbind("load"),e("#"+n).remove()}),a.parent().submit()},upload:function(e){var a=e.length,n=a;if(t.init(),void 0!==e)for(var r=0;r<a;r++){var o=e[r].name.toLowerCase().split(/\./);if(o=o[o.length-1],t.type&&-1==t.type.indexOf(o)){var l={err_no:1,err_des:"File type error",fileno:r,filename:e[r].name};t.error(l),0==--n&&t.completed()}else if(t.maxsize>0&&e[r].size>1048576*t.maxsize){l={err_no:2,err_des:"File size error",fileno:r,filename:e[r].name};t.error(l),0==--n&&t.completed()}else{var i={fileno:r,filename:e[r].name,perc:0,sent:0,total:0};t.start(i);try{var c=new XMLHttpRequest}catch(e){return alert("Your browser does not support AJAX!"),!1}c.open("POST",t.post_upload,!0),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.upload.filenumb=r,c.filenumb=r,c.upload.filename=e[r].name,c.upload.addEventListener("progress",function(e){if(e.lengthComputable){var a=Math.ceil(e.loaded/e.total*100),n={fileno:this.filenumb,filename:this.filename,perc:a,sent:e.loaded,total:e.total};t.progress(n)}},!1),c.addEventListener("load",function(e){var a=jQuery.parseJSON(e.target.responseText);a.fileno=this.filenumb,t.loaded(a),0==--n&&t.completed()},!1);var u=new FormData;u.append("folder",t.folder),u.append("file_element",t.file_elem),u.append("udata",t.user_data),u.append(t.file_elem,e[r]),c.send(u)}}else alert("no support")}};e.fn.mfupload=function(n){t={init:a.init,start:a.start,loaded:a.loaded,progress:a.progress,completed:a.completed,ini_text:"Drag image to here",over_text:"Drop image",over_col:"white",over_bkcol:"green",post_upload:"cover/upload",maxsize:5,type:"",folder:"./",user_data:"",file_elem:""},n&&e.extend(t,n),this.each(function(){window.location==window.parent.location&&(t.file_elem="mf_file_"+e(this).attr("id"),t.iframe="mf_iframe_"+e(this).attr("id"),e(this).append('<div class="mf_upload_m"><form method="post" enctype="multipart/form-data" class="file" action="'+t.post_upload+'" target="'+t.iframe+'"><input type="file" class="file" name="'+t.file_elem+'" id="'+t.file_elem+'" multiple /><input type="hidden" name="folder" value="'+t.folder+'" /><input type="hidden" name="file_element" value="'+t.file_elem+'" /></form><div class="mf_upload_ins"></div></div>'),e(this).find(".mf_upload_m").css({position:"relative",margin:0,padding:0,width:"inherit",height:"inherit"}),e(this).find(".file").css({position:"relative","text-align":"right","-moz-opacity":"0",filter:"alpha(opacity: 0)",opacity:"0","z-index":"2",width:"100%",height:"100%",top:0,left:0}),e(this).find(".mf_upload_ins").css({position:"absolute","text-align":"center","z-index":"1",width:"100%",height:"100%",top:0,left:0}),e(this).find(".mf_upload_ins").empty().html(t.ini_text),e(this).bind({dragleave:function(a){a.preventDefault(),e(this).find(".mf_upload_ins").css("color","inherit"),e(this).find(".mf_upload_ins").css("background-color","inherit").html(t.ini_text)},drop:function(n){n.preventDefault(),e(this).find(".mf_upload_ins").css("color","inherit"),e(this).find(".mf_upload_ins").css("background-color","inherit").html(t.ini_text);var r=n.originalEvent;r.dataTransfer.files?a.upload(r.dataTransfer.files):alert("Drag and Drop not supported by your browser.")},dragover:function(a){a.preventDefault(),e(this).find(".mf_upload_ins").css("color",t.over_col),e(this).find(".mf_upload_ins").css("background-color",t.over_bkcol),e(this).find(".mf_upload_ins").html(t.over_text)}}),e(this).find("input[type=file]").bind("change",function(n){n.preventDefault(),n.target.files?a.upload(n.target.files):a.upload_old(e(this),t.iframe)}))})}}(jQuery)},197:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=i(a(6)),o=i(a(1)),l=i(a(154));function i(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.save=a.save.bind(a),a.modal=o.default.createRef(),a.uploadBox=o.default.createRef(),a.btnSave=o.default.createRef(),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default.Component),n(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){$(e.modal.current).on("shown.bs.modal",function(){return $("#ncName").focus()})},500),r.default.showNewsCategoryModal=function(t){var a="/admin/news/category/edit/"+t._id;r.default.put(a,function(e){},function(e){return r.default.notify("Sửa danh mục tin tức bị lỗi","danger")});var n=t||{title:"",image:"/img/avatar.jpg"},o=n.title,l=n.image;$("#ncName").data("title",o).val(o),$(e.btnSave.current).data("id",t._id),e.uploadBox.current.setImage(l),$(e.modal.current).modal("show")}}},{key:"save",value:function(e){var t=this,a="/admin/news/category",n={_id:$(e.target).data("id"),changes:{title:$("#ncName").val().trim()}};""==n.changes.title?(r.default.notify("Tên danh mục bị trống!","danger"),$("#ncName").focus()):r.default.put(a,n,function(e){e.error?(r.default.notify("Lưu danh mục tin tức bị lỗi!","danger"),console.error("PUT: "+a+". "+e.error)):t.props.onSaveSuccess&&($(t.modal.current).modal("hide"),r.default.notify("Tên danh mục lưu thành công!","success"),t.props.onSaveSuccess())},function(e){r.default.notify("Lưu danh mục tin tức bị lỗi!","danger")})}},{key:"render",value:function(){return o.default.createElement("div",{className:"modal",tabIndex:"-1",role:"dialog",ref:this.modal},o.default.createElement("div",{className:"modal-dialog",role:"document"},o.default.createElement("div",{className:"modal-content"},o.default.createElement("div",{className:"modal-header"},o.default.createElement("h5",{className:"modal-title"},"Tin tức: Danh mục"),o.default.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},o.default.createElement("span",{"aria-hidden":"true"},"×"))),o.default.createElement("div",{className:"modal-body"},o.default.createElement("div",{className:"form-group"},o.default.createElement("label",{htmlFor:"ncName"},"Tên danh mục"),o.default.createElement("input",{className:"form-control",id:"ncName",type:"text",placeholder:"Tên danh mục"})),o.default.createElement("div",{className:"form-group"},o.default.createElement("label",null,"Hình đại diện"),o.default.createElement(l.default,{postUrl:"/admin/upload",uploadType:"NewsCategoryImage",ref:this.uploadBox}))),o.default.createElement("div",{className:"modal-footer"},o.default.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Đóng"),o.default.createElement("button",{type:"button",className:"btn btn-primary",ref:this.btnSave,onClick:this.save},"Lưu")))))}}]),t}();t.default=c}}]);