(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{130:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=c(a(6));a(52);var r=c(a(1)),i=a(7);function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.table=r.default.createRef(),a.getData=a.getData.bind(a),a.create=a.create.bind(a),a.changeActive=a.changeActive.bind(a),a.swap=a.swap.bind(a),a.state={page:null},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),n(t,[{key:"componentDidMount",value:function(){this.getData()}},{key:"create",value:function(){var e=this,t="/admin/news/list";l.default.post(t,function(a){a.error?(l.default.notify("Tạo tin tức bị lỗi!","danger"),console.error("POST: "+t+". "+a.error)):e.props.history.push("/admin/news/edit/"+a.item._id)},function(e){return l.default.notify("Tạo tin tức bị lỗi!","danger")})}},{key:"getData",value:function(){var e=this,t="/admin/news/list/page/1/100";l.default.get(t,function(a){a.error?(l.default.notify("Lấy tin tức bị lỗi!","danger"),console.error("GET: "+t+". "+a.error)):e.setState({page:a.page})},function(e){return l.default.notify("Lấy tin tức bị lỗi!","danger")})}},{key:"swap",value:function(e,t){var a=this,n="/admin/news/list/swap/";l.default.put(n,{id:e._id,isMoveUp:t},function(e){e.error?(l.default.notify("Thay đổi thứ tự tin tức bị lỗi!","danger"),console.error("PUT: "+n+". "+e.error)):a.getData()},function(e){return l.default.notify("Thay đổi thứ tự tin tức bị lỗi!","danger")})}},{key:"changeActive",value:function(e,t){var a=this,n="/admin/news/list";l.default.put(n,{_id:e._id,changes:{active:!e.active}},function(e){if(e.error)l.default.notify("Thay đổi kích hoạt tin tức bị lỗi!","danger"),console.error("PUT: "+n+". "+e.error);else{l.default.notify("Tin tức "+(e.item.active?"được ":"mất ")+"kích hoạt!","info");var r=Object.assign({},a.state);r.page.list[t].active=e.item.active,a.setState(r)}},function(e){return l.default.notify("Thay đổi kích hoạt tin tức bị lỗi!","danger")})}},{key:"delete",value:function(e){var t=this;swal({title:"Tin tức: Xóa tin tức",text:"Bạn có chắc bạn muốn xóa tin tức này?",icon:"warning",dangerMode:!0,buttons:{cancel:!0,confirm:!0}}).then(function(a){if(a){var n="/admin/news/list";l.default.delete(n,{id:e._id},function(e){e.error?(l.default.notify("Xóa tin tức bị lỗi!","danger"),console.error("DELETE: "+n+". "+e.error)):(swal({text:"Tin tức được xóa thành công!",icon:"error",button:!1,timer:1500}),t.getData())},function(e){return l.default.notify("Xóa tin tức bị lỗi!","danger")})}})}},{key:"render",value:function(){var e=this,t=null;return t=this.state.page&&this.state.page.list&&this.state.page.list.length>0?r.default.createElement("table",{className:"table table-hover table-bordered",ref:this.table},r.default.createElement("thead",null,r.default.createElement("tr",null,r.default.createElement("th",{style:{width:"80%"}},"Title"),r.default.createElement("th",{style:{width:"20%",textAlign:"center"}},"Image"),r.default.createElement("th",{style:{width:"auto"}},"Active"),r.default.createElement("th",{style:{width:"auto",textAlign:"center"}},"Actions"))),r.default.createElement("tbody",null,this.state.page.list.map(function(t,a){return r.default.createElement("tr",{key:a},r.default.createElement("td",null,t.title),r.default.createElement("td",{style:{width:"20%",textAlign:"center"}},r.default.createElement("img",{src:l.default.url(t.image),alt:"avatar",style:{height:"32px"}})),r.default.createElement("td",{className:"toggle",style:{textAlign:"center"}},r.default.createElement("label",null,r.default.createElement("input",{type:"checkbox",defaultChecked:t.active,onClick:function(){return e.changeActive(t,a)}}),r.default.createElement("span",{className:"button-indecator"}))),r.default.createElement("td",{className:"btn-group"},r.default.createElement("a",{className:"btn btn-success",href:"#",onClick:function(){return e.swap(t,!0)}},r.default.createElement("i",{className:"fa fa-lg fa-arrow-up"})),r.default.createElement("a",{className:"btn btn-success",href:"#",onClick:function(){return e.swap(t,!1)}},r.default.createElement("i",{className:"fa fa-lg fa-arrow-down"})),r.default.createElement(i.Link,{to:"/admin/news/edit/"+t._id,"data-id":t._id,className:"btn btn-primary"},r.default.createElement("i",{className:"fa fa-lg fa-edit"})),r.default.createElement("a",{className:"btn btn-danger",href:"#",onClick:function(){return e.delete(t)}},r.default.createElement("i",{className:"fa fa-lg fa-trash"}))))}))):r.default.createElement("p",null,"Không có bài viết!"),r.default.createElement("main",{className:"app-content"},r.default.createElement("div",{className:"app-title"},r.default.createElement("div",null,r.default.createElement("h1",null,r.default.createElement("i",{className:"fa fa-dashboard"})," Tin tức: Danh sách"),r.default.createElement("p",null)),r.default.createElement("ul",{className:"app-breadcrumb breadcrumb"},r.default.createElement("li",{className:"breadcrumb-item"},r.default.createElement(i.Link,{to:"/admin"},r.default.createElement("i",{className:"fa fa-home fa-lg"}))),r.default.createElement("li",{className:"breadcrumb-item"},r.default.createElement("a",{href:"#"},"Tin tức: Danh sách")))),r.default.createElement("div",{className:"row tile"},t),r.default.createElement("button",{type:"button",className:"btn btn-primary btn-circle",style:{position:"fixed",right:"10px",bottom:"10px"},onClick:this.create},r.default.createElement("i",{className:"fa fa-lg fa-plus"})))}}]),t}();t.default=u}}]);